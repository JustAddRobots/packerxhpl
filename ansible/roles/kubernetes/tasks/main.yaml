---
- name: Add kubernetes repo
  yum_repository:
    baseurl: https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
    description: Kubernetes repo
    file: kubernetes
    gpgcheck: true
    gpgkey: https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
    name: kubernetes

- name: Install kubernetes
  dnf:
    name:
        - kubelet
        - kubeadm
        - kubectl
    state: present
  vars:
    ansible_python_interpreter: /usr/bin/python

- name: Start kubectl
  systemd:
    enabled: yes    
    name: kubelet
    state: started
